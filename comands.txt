from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import time
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import keyring
import logging
from selenium.common.exceptions import WebDriverException


# Save credentials (run this part only once)
keyring.set_password("GraphExplorer", "jhonny.souza", "")

# Configure logging to print to the console
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
def login_and_click():
    # Retrieve credentials
    username = "jhonny.souza"
    password = keyring.get_password("GraphExplorer", username)
    # Set up the WebDriver (make sure you have the appropriate driver installed)
    driver = webdriver.Chrome()

    try:
        # Open the specified webpage
        driver.get("https://developer.microsoft.com/en-us/graph/graph-explorer")

        # Locate the username input field using XPath and send the username
        username_field = driver.find_element(By.XPATH, '//*[@id="userid"]')
        username_field.send_keys(username)


        # Locate the password input field using XPath and send the password
        password_field = driver.find_element(By.XPATH, '//*[@id="password"]')
        password_field.send_keys(password)

        # Press Enter to submit the form
        password_field.send_keys(Keys.RETURN)

        # Wait for the element to be clickable and then click it
        WebDriverWait(driver, 120).until(EC.element_to_be_clickable((By.XPATH, '//*[@id="pt1:_UIScil1u"]'))).click()
        # Call the next function

    finally:
        # Close the browser
        driver.quit()